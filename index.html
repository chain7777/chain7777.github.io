<!doctype html>
<html lang="sl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NFC obesek – ime + velikost + cena</title>
  <style>
    :root { --bg:#0b1020; --panel:#121a33; --text:#e9eeff; --muted:#aab3d6; --border:#263056; }
    * { box-sizing: border-box; }
    body{
      margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; color:var(--text);
      background: radial-gradient(1200px 600px at 20% 0%, #16235b 0%, var(--bg) 45%),
                  radial-gradient(900px 500px at 80% 20%, #4a1d6a 0%, var(--bg) 55%);
    }
    header{ padding:24px 18px; max-width:1100px; margin:0 auto; }
    header h1{ margin:0 0 6px; font-size:22px; }
    header p{ margin:0; color:var(--muted); }

    .wrap{ max-width:1100px; margin:0 auto; padding:0 18px 28px; }
    .grid{ display:grid; grid-template-columns: 360px 1fr; gap:16px; }
    @media (max-width: 900px){ .grid{ grid-template-columns:1fr; } }

    .card{
      background: color-mix(in srgb, var(--panel) 86%, transparent);
      border:1px solid var(--border);
      border-radius:16px;
      padding:14px;
      box-shadow:0 10px 35px rgba(0,0,0,.25);
      backdrop-filter: blur(8px);
    }

    label{ font-size:12px; color:var(--muted); }
    input, select{
      width:100%;
      border-radius:12px;
      border:1px solid var(--border);
      background:#0d1430;
      color:var(--text);
      padding:10px 12px;
      outline:none;
    }
    input[type="range"]{ padding:0; height: 38px; }
    .row{ display:grid; gap:10px; }

    .twoCol{ display:grid; grid-template-columns: 1fr 1fr; gap:10px; }
    @media (max-width: 420px){ .twoCol{ grid-template-columns:1fr; } }

    .preview{ border-radius:18px; overflow:hidden; border:1px solid var(--border); min-height:360px; }
    .previewInner{ padding:18px; display:grid; gap:14px; }
    .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding:7px 10px; border-radius:999px;
      border:1px solid rgba(255,255,255,.16);
      font-size:12px; color:rgba(255,255,255,.92);
      background: rgba(255,255,255,.06);
      width: fit-content;
    }

    .stage{ width:100%; display:grid; place-items:center; padding: 12px 0 6px; }
    .scaled{ transform-origin:center; will-change:transform; }

    .figure{
      position: relative;
      width: 320px;
      max-width: 80vw;
      aspect-ratio: 1 / 1;
      border-radius: 18px;
      overflow: hidden;
      background: #EAF2FF;
      border: 1px solid rgba(255,255,255,.14);
    }
    .figure img{ width:100%; height:100%; object-fit:contain; display:block; }

    .nameOverlay{
      position:absolute;
      inset:0;
      display:grid;
      place-items:center;
      pointer-events:none;
      text-align:center;
      padding: 14px;
      font-weight: 800;
      letter-spacing: 0.5px;
      color: #d13b3b;
      text-shadow: 0 1px 0 rgba(255,255,255,.35);
      font-size: 30px;
      line-height: 1;
      white-space: nowrap;
      overflow: hidden;
    }

    .metaRow{
      display:flex; flex-wrap:wrap; gap:10px;
      align-items:center; justify-content:space-between;
      border-top:1px solid rgba(255,255,255,.10);
      padding-top:10px;
    }
    .pill{
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      border-radius:999px;
      padding: 6px 10px;
      font-size:12px;
      color: rgba(255,255,255,.88);
    }
    .hint{ font-size:12px; color: var(--muted); }
  </style>
</head>
<body>
<header>
  <h1>NFC obesek – vpis imena</h1>
  <p>Velikost: <b>30–60 mm</b>. Cena se izračuna samodejno: <b>30mm = 8€</b>, <b>60mm = 11€</b>. Stranka cene ne more spreminjati.</p>
</header>

<div class="wrap">
  <div class="grid">
    <section class="card">
      <div class="row">
        <div>
          <label>Izberi model</label>
          <select id="productSelect"></select>
        </div>

        <div>
          <label>Vpiši ime</label>
          <input id="nameInput" type="text" placeholder="npr. MARK" maxlength="18" />
        </div>

        <div class="twoCol">
          <div>
            <label>Velikost (mm): <span id="sizeLabel">30</span></label>
            <input id="sizeRange" type="range" />
            <div class="hint">Drsnik je zaklenjen na 30–60 mm.</div>
          </div>

          <div>
            <label>Cena (€) (samodejno)</label>
            <input id="priceBox" type="text" readonly />
            <div class="hint">30mm = 8€ … 60mm = 11€</div>
          </div>
        </div>

        <div class="metaRow">
          <span class="pill" id="modelPill">Model: —</span>
          <span class="pill" id="pricePill">Cena: —</span>
        </div>

        <div class="pill" style="opacity:.9;">
          Slike v repo: <b>/images/p1.png</b>, <b>/images/p2.png</b>, <b>/images/p3.png</b>
        </div>
      </div>
    </section>

    <section class="card preview">
      <div class="previewInner">
        <span class="chip">● Live preview</span>

        <div class="stage">
          <div id="scaled" class="scaled">
            <div id="figure" class="figure">
              <img id="productImg" alt="Produkt" />
              <div id="nameOverlay" class="nameOverlay">VPIŠI IME</div>
            </div>
          </div>
        </div>

        <div class="metaRow">
          <span class="pill" id="previewNamePill">Ime: —</span>
          <span class="pill" id="previewSizePill">Velikost: —</span>
          <span class="pill" id="previewPricePill">Cena: —</span>
        </div>
      </div>
    </section>
  </div>
</div>

<script>
  // ====== HARD LIMITI ======
  const MIN_MM = 30;
  const MAX_MM = 60;
  const MIN_PRICE = 8.00;
  const MAX_PRICE = 11.00;

  function clamp(n, min, max){
    return Math.max(min, Math.min(max, n));
  }

  function calcPrice(sizeMm){
    const s = clamp(Number(sizeMm), MIN_MM, MAX_MM);
    const t = (s - MIN_MM) / (MAX_MM - MIN_MM); // 0..1
    const price = MIN_PRICE + t * (MAX_PRICE - MIN_PRICE);
    return Math.round(price * 100) / 100;
  }

  function euro(n){
    // prikaz npr. "8,00 €"
    return new Intl.NumberFormat("sl-SI", { style:"currency", currency:"EUR" }).format(n);
  }

  // ====== PRODUKTI ======
  const products = [
    { id:"p1", label:"Oblak",          image:"images/p1.png", aspect:"1/1" },
    { id:"p2", label:"Nogometna žoga", image:"images/p2.png", aspect:"1/1" },
    { id:"p3", label:"Tenis lopar",    image:"images/p3.png", aspect:"3/4" },
  ];

  const els = {
    select: document.getElementById("productSelect"),
    name: document.getElementById("nameInput"),
    sizeRange: document.getElementById("sizeRange"),
    sizeLabel: document.getElementById("sizeLabel"),
    priceBox: document.getElementById("priceBox"),

    img: document.getElementById("productImg"),
    overlay: document.getElementById("nameOverlay"),
    figure: document.getElementById("figure"),
    scaled: document.getElementById("scaled"),

    modelPill: document.getElementById("modelPill"),
    pricePill: document.getElementById("pricePill"),
    previewNamePill: document.getElementById("previewNamePill"),
    previewSizePill: document.getElementById("previewSizePill"),
    previewPricePill: document.getElementById("previewPricePill"),
  };

  let currentId = products[0].id;

  function renderSelect(){
    els.select.innerHTML = "";
    for (const p of products){
      const opt = document.createElement("option");
      opt.value = p.id;
      opt.textContent = p.label;
      els.select.appendChild(opt);
    }
    els.select.value = currentId;
  }

  function getCurrent(){
    return products.find(p => p.id === currentId) || products[0];
  }

  function fitTextToBox(el, maxWidthPx, maxFontPx, minFontPx){
    let size = maxFontPx;
    el.style.fontSize = size + "px";
    while (el.scrollWidth > maxWidthPx && size > minFontPx){
      size -= 1;
      el.style.fontSize = size + "px";
    }
  }

  function scaleFromSize(sizeMm){
    const s = clamp(Number(sizeMm), MIN_MM, MAX_MM);
    const t = (s - MIN_MM) / (MAX_MM - MIN_MM);
    // 30mm -> 0.85, 60mm -> 1.25
    return 0.85 + t * (1.25 - 0.85);
  }

  function readSize(){
    // 100% prisilimo v range 30–60
    const raw = Number(els.sizeRange.value);
    const clamped = clamp(raw, MIN_MM, MAX_MM);
    if (String(clamped) !== String(els.sizeRange.value)) {
      els.sizeRange.value = String(clamped);
    }
    return clamped;
  }

  function render(){
    const p = getCurrent();

    // slika + aspect
    els.img.src = p.image;
    els.figure.style.aspectRatio = p.aspect || "1/1";
    els.modelPill.textContent = `Model: ${p.label}`;

    // size
    const sizeMm = readSize();
    els.sizeLabel.textContent = String(sizeMm);

    // price
    const price = calcPrice(sizeMm);
    els.priceBox.value = euro(price);
    els.pricePill.textContent = `Cena: ${euro(price)}`;

    // name overlay
    const name = (els.name.value || "").trim().toUpperCase();
    els.name.value = name; // keep uppercase
    els.overlay.textContent = name ? name : "VPIŠI IME";
    els.previewNamePill.textContent = name ? `Ime: ${name}` : "Ime: —";

    // preview pills
    els.previewSizePill.textContent = `Velikost: ${sizeMm} mm`;
    els.previewPricePill.textContent = `Cena: ${euro(price)}`;

    // scale whole preview
    els.scaled.style.transform = `scale(${scaleFromSize(sizeMm)})`;

    // fit text to 78% width
    const boxWidth = els.figure.clientWidth * 0.78;
    fitTextToBox(els.overlay, boxWidth, 34, 16);
  }

  // ====== EVENTS ======
  els.select.addEventListener("change", () => {
    currentId = els.select.value;
    render();
  });

  els.name.addEventListener("input", render);

  els.sizeRange.addEventListener("input", render);

  window.addEventListener("resize", render);

  // ====== INIT ======
  renderSelect();

  // nastavi drsnik hard
  els.sizeRange.min = String(MIN_MM);
  els.sizeRange.max = String(MAX_MM);
  els.sizeRange.step = "1";
  els.sizeRange.value = String(MIN_MM);

  render();
</script>
</body>
</html>
